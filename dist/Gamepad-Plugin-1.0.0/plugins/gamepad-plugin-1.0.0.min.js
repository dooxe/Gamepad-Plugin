Kiwi.Plugins.Gamepad={name:"Gamepad",version:"1.0.0",minimumKiwiVersion:"1.0.0"},Kiwi.PluginManager.register(Kiwi.Plugins.Gamepad),Kiwi.Plugins.Gamepad.create=function(a){var b=Kiwi.Plugins.Gamepad.supportsGamepad();return b||console.error("Your browser / platform does not support Gamepad Controllers"),a.gamepads=new Kiwi.Plugins.Gamepad.Manager(a),a.gamepads},Kiwi.Plugins.Gamepad.supportsGamepad=function(){return"getGamepads"in navigator},Kiwi.Plugins.Gamepad.Manager=function(a){this.game=a;for(var b=[],c=navigator.getGamepads().length,d=c-1;d>=0;d--){var e=new Kiwi.Plugins.Gamepad.Controller(this,.25,.25);b.push(e)}this.gamepads=b,this.gamepadConnected=new Kiwi.Signal,this.gamepadDisconnected=new Kiwi.Signal;var f=this;window.addEventListener("gamepadconnected",function(a){f.gamepadConnected.dispatch(a.gamepad)}),window.addEventListener("gamepaddisconnected",function(a){f.gamepadDisconnected.dispatch(a.gamepad)})},Kiwi.Plugins.Gamepad.Manager.prototype.update=function(){var a,b=navigator.getGamepads();for(a=0;a<b.length;a++)b[a]&&(this.gamepads[a].checkButtons(b[a]),this.gamepads[a].checkAxes(b[a]))},Kiwi.Plugins.Gamepad.Controller=function(a,b,c){this.parent=a,this.axesThreshold=b,this.triggerThreshold=c,this.createButtons(),this.createAxes(),this.threshold=b,this.buttonOnUp=new Kiwi.Signal,this.buttonIsDown=new Kiwi.Signal,this.buttonOnDownOnce=new Kiwi.Signal,this.justReleased=new Kiwi.Signal,this.thumbstickOnUp=new Kiwi.Signal,this.thumbstickIsDown=new Kiwi.Signal,this.thumbstickOnDownOnce=new Kiwi.Signal},Kiwi.Plugins.Gamepad.Controller.prototype.createButtons=function(){this.button0=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_A"),this.button1=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_B"),this.button2=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_X"),this.button3=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_Y"),this.button4=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_LEFT_BUMPER"),this.button5=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_RIGHT_BUMPER"),this.button6=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_LEFT_TRIGGER",.2),this.button7=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_RIGHT_TRIGGER",.2),this.button8=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_BACK"),this.button9=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_START"),this.button10=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_LEFT_STICK"),this.button11=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_RIGHT_STICK"),this.button12=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_DPAD_UP"),this.button13=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_DPAD_DOWN"),this.button14=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_DPAD_LEFT"),this.button15=new Kiwi.Plugins.Gamepad.Button(0,"XBOX_DPAD_RIGHT"),this.rightButtons=[this.button0,this.button1,this.button2,this.button3],this.bumpers=[this.button4,this.button5],this.trigers=[this.button6,this.button7],this.thumbsticks=[this.button10,this.button11],this.dpad=[this.button12,this.button13,this.button14,this.button15],this.optionButtons=[this.button8,this.button9,this.button16],this.buttons=[this.button0,this.button1,this.button2,this.button3,this.button4,this.button5,this.button6,this.button7,this.button8,this.button9,this.button10,this.button11,this.button12,this.button13,this.button14,this.button15]},Kiwi.Plugins.Gamepad.Controller.prototype.createAxes=function(){this.axis0=new Kiwi.Plugins.Gamepad.Thumbstick(0,"XBOX_LEFT_HORZ",.1),this.axis1=new Kiwi.Plugins.Gamepad.Thumbstick(0,"XBOX_LEFT_VERT",.1),this.axis2=new Kiwi.Plugins.Gamepad.Thumbstick(0,"XBOX_RIGHT_HORZ",.1),this.axis3=new Kiwi.Plugins.Gamepad.Thumbstick(0,"XBOX_RIGHT_VERT",.1),this.axes=[this.axis0,this.axis1,this.axis2,this.axis3],this.leftAxis=[this.axis0,this.axis1],this.rightAxis=[this.axis2,this.axis3]},Kiwi.Plugins.Gamepad.Controller.prototype.checkButtons=function(a){for(var b=this.buttons.length-1;b>=0;b--)this.buttons[b].pressed===a.buttons[b].pressed?this.buttons[b].pressed===!0&&(this.buttons[b].isDown(a.buttons[b]),this.buttonIsDown.dispatch(this.buttons[b])):this.buttons[b].pressed!==a.buttons[b].pressed&&(a.buttons[b].pressed===!0?(this.buttons[b].press(a.buttons[b]),this.buttonIsDown.dispatch(this.buttons[b]),this.buttonOnDownOnce.dispatch(this.buttons[b])):a.buttons[b].pressed===!1&&(this.buttons[b].release(),this.buttonOnUp.dispatch(this.buttons[b])))},Kiwi.Plugins.Gamepad.Controller.prototype.checkAxes=function(a){var b;for(b=this.axes.length-1;b>=0;b--)Math.abs(this.axes[b].value)>this.threshold&&Math.abs(a.axes[b])>this.threshold?Math.abs(this.axes[b].value)>this.threshold&&(this.axes[b].isDown(a.axes[b]),this.thumbstickIsDown.dispatch(this.axes[b])):(Math.abs(this.axes[b].value)>this.threshold||Math.abs(a.axes[b])>this.threshold)&&(Math.abs(this.axes[b].value)>this.threshold?(this.axes[b].press(a.axes[b]),this.thumbstickIsDown.dispatch(this.axes[b]),this.thumbstickOnDownOnce.dispatch(this.axes[b])):Math.abs(this.axes[b].value)<this.threshold&&(this.axes[b].release(),this.thumbstickOnUp.dispatch(this.axes[b]))),this.axes[b].value=a.axes[b]},Kiwi.Plugins.Gamepad.Button=function(a,b,c){this.index=a,this.name=b,this.threshold=c||0,this.value=0,this.pressed=!1,this.pressed=!1},Kiwi.Plugins.Gamepad.Button.prototype.release=function(){this.pressed=!1,this.value=0},Kiwi.Plugins.Gamepad.Button.prototype.press=function(a){this.pressed=!0,this.value=a.value},Kiwi.Plugins.Gamepad.Button.prototype.isDown=function(a){this.pressed=!0,this.value=a.value},Kiwi.Plugins.Gamepad.Thumbstick=function(a,b,c){this.threshold=c,this.name=b,this.index=a,this.threshold=c||.25,this.value=0},Kiwi.Plugins.Gamepad.Thumbstick.prototype.release=function(){this.value=0},Kiwi.Plugins.Gamepad.Thumbstick.prototype.press=function(a){this.value=a},Kiwi.Plugins.Gamepad.Thumbstick.prototype.isDown=function(a){this.value=a};